{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,8DAAgC;AAChC,6DAAoD;AACpD,2CAA0C;AAC1C,6CAAqC;AACrC,8BAA2B;AAC3B,8CAA2B;AAC3B,6CAA0B;AAE1B,YAAY;AACZ,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAA;AAElC,IAAI,OAAO,qBAAM,CAAC,QAAQ,KAAK,UAAU,EAAE;IACzC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,oCAAc,EAAE,CAAA;IAC7C,KAAK,CAAC,KAAK,EAAE,CAAA;IACb,KAAK,CAAC,KAAK,EAAE,CAAA;IAEb,qBAAM,CAAC,QAAQ,CAAC,IAAA,mBAAM,EAAC,oBAAoB,CAAC,EAAE;QAC5C,SAAS,EAAE,IAAA,mBAAM,EAAC,YAAY,CAAC;QAC/B,IAAI,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE;QACrB,YAAY,EAAE,CAAC,KAAK,CAAC;KACtB,CAAC,CAAA;IAEF,KAAK,CAAC,WAAW,CAAC,EAAE,WAAW,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAA;CAC3D;AAED,oCAAoC;AACvB,QAAA,KAAK,GAAG,IAAI,wBAAY,EAAE,CAAA","sourcesContent":["import Module from 'node:module'\nimport { MessageChannel } from 'node:worker_threads'\nimport { DaemonClient } from './client.js'\nimport { getUrl } from './get-url.js'\nimport './hooks/require.js'\nexport * from './client.js'\nexport * from './types.js'\n\n//@ts-ignore\nprocess.setSourceMapsEnabled(true)\n\nif (typeof Module.register === 'function') {\n  const { port1, port2 } = new MessageChannel()\n  port1.unref()\n  port2.unref()\n\n  Module.register(getUrl('./hooks/loader.mjs'), {\n    parentURL: getUrl('./index.js'),\n    data: { port: port2 },\n    transferList: [port2],\n  })\n\n  port1.postMessage({ stderrIsTTY: !!process.stderr.isTTY })\n}\n\n// the imp is a client of the daemon\nexport const tsimp = new DaemonClient()\n"]}