{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,aAAa,CAAA;AAChC,OAAO,EAAE,cAAc,EAAE,MAAM,qBAAqB,CAAA;AACpD,OAAO,EAAE,YAAY,EAAE,MAAM,aAAa,CAAA;AAC1C,OAAO,EAAE,MAAM,EAAE,MAAM,cAAc,CAAA;AACrC,OAAO,oBAAoB,CAAA;AAC3B,cAAc,aAAa,CAAA;AAC3B,cAAc,YAAY,CAAA;AAE1B,YAAY;AACZ,OAAO,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAA;AAElC,IAAI,OAAO,MAAM,CAAC,QAAQ,KAAK,UAAU,EAAE;IACzC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,cAAc,EAAE,CAAA;IAC7C,KAAK,CAAC,KAAK,EAAE,CAAA;IACb,KAAK,CAAC,KAAK,EAAE,CAAA;IAEb,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,oBAAoB,CAAC,EAAE;QAC5C,SAAS,EAAE,MAAM,CAAC,YAAY,CAAC;QAC/B,IAAI,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE;QACrB,YAAY,EAAE,CAAC,KAAK,CAAC;KACtB,CAAC,CAAA;IAEF,KAAK,CAAC,WAAW,CAAC,EAAE,WAAW,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAA;CAC3D;AAED,oCAAoC;AACpC,MAAM,CAAC,MAAM,KAAK,GAAG,IAAI,YAAY,EAAE,CAAA","sourcesContent":["import Module from 'node:module'\nimport { MessageChannel } from 'node:worker_threads'\nimport { DaemonClient } from './client.js'\nimport { getUrl } from './get-url.js'\nimport './hooks/require.js'\nexport * from './client.js'\nexport * from './types.js'\n\n//@ts-ignore\nprocess.setSourceMapsEnabled(true)\n\nif (typeof Module.register === 'function') {\n  const { port1, port2 } = new MessageChannel()\n  port1.unref()\n  port2.unref()\n\n  Module.register(getUrl('./hooks/loader.mjs'), {\n    parentURL: getUrl('./index.js'),\n    data: { port: port2 },\n    transferList: [port2],\n  })\n\n  port1.postMessage({ stderrIsTTY: !!process.stderr.isTTY })\n}\n\n// the imp is a client of the daemon\nexport const tsimp = new DaemonClient()\n"]}