{"version":3,"file":"diagnostic.js","sourceRoot":"","sources":["../../../src/service/diagnostic.ts"],"names":[],"mappings":";;;;;;AAAA,4DAAgD;AAChD,2EAAkE;AAElE,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,EAAE,CAAA;AAEzB,4EAA4E;AAC5E,2EAA2E;AAC3E,2EAA2E;AAC3E,UAAU;AACH,MAAM,SAAS,GAAG,CACvB,WAAyB,EACzB,MAAgB,EAChB,EAAE,CACF,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,IAAA,cAAM,EAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAA;AAJzD,QAAA,SAAS,aAIgD;AAEtE,MAAM,IAAI,GAAG;IACX,mBAAmB,EAAE,GAAG,EAAE,CAAC,GAAG;IAC9B,UAAU,EAAE,GAAG,EAAE,CAAC,IAAI;IACtB,oBAAoB,EAApB,gDAAoB;CACrB,CAAA;AAEM,MAAM,MAAM,GAAG,CACpB,UAAsB,EACtB,MAAM,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EACvB,EAAE,CACV,MAAM;IACJ,CAAC,CAAC,oBAAE,CAAC,oCAAoC,CAAC,CAAC,UAAU,CAAC,EAAE,IAAI,CAAC;IAC7D,CAAC,CAAC,oBAAE,CAAC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAA;AAN9B,QAAA,MAAM,UAMwB","sourcesContent":["import ts, { type Diagnostic } from 'typescript'\nimport { getCanonicalFileName } from './get-canonical-filename.js'\n\nconst cwd = process.cwd()\n\n// Ignore the rootDir warning. Just means we're running something outside of\n// cwd, which happens a lot in tests where we're spinning up the daemon and\n// stuff repeatedly in test dirs, but almost never irl, and isn't a problem\n// anyway.\nexport const reportAll = (\n  diagnostics: Diagnostic[],\n  pretty?: boolean\n) =>\n  diagnostics.filter(d => d.code !== 6059).map(d => report(d, pretty))\n\nconst host = {\n  getCurrentDirectory: () => cwd,\n  getNewLine: () => '\\n',\n  getCanonicalFileName,\n}\n\nexport const report = (\n  diagnostic: Diagnostic,\n  pretty = !!process.stderr.isTTY\n): string =>\n  pretty\n    ? ts.formatDiagnosticsWithColorAndContext([diagnostic], host)\n    : ts.formatDiagnostic(diagnostic, host)\n"]}